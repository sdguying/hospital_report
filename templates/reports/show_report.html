{% extends 'base.html' %}
{% block title %}详细内容{% endblock %}
{% block content %}
    <table border="1">
        <tr>
            <th>{{ report.title }} - <a href="{% url 'reports:edit_report_info' report.id %}">修改</a></th>
            <th>检查项目信息</th>
        </tr>
        <tr>
            <td>
                <table>
                    <tr><td>{{ report.report_num }}</td></tr>
                    <tr><td>{{ report.name }}</td></tr>
                    <tr><td>{{ report.sex }}</td></tr>
                    <tr><td>{{ report.age }}</td></tr>
                    <tr><td>{{ report.work_unit }}</td></tr>
                    <tr><td>{{ report.hospital }}</td></tr>
                    <tr><td>{{ report.date }}</td></tr>
                    <tr>
                        <td><h5>添加项目</h5></td>
                    </tr>
                    <tr>
                        <td><form action="{% url 'reports:show_report' report.id %}" method="post">{% csrf_token %}
                            <p>所属科室{{ form.category }} -
                                <a href="{% url 'reports:add_new_category' %}">添加/修改全局科室名称</a></p>
                            <p>项目{{ form.name }}</p>
                            <p>检查结果{{ form.check_results }}</p>
                            <p>单位{{ form.unit }}</p>
                            <p>范围{{ form.reference_range }}</p>
                            <p>提示{{ form.tips }}</p>
                            <button name="submit">提交</button>
                            </form>
                        </td>
                    </tr>
                </table>
            </td>
            <td>
                {% for category_name, entries in dicts.items %}
                        <h3>{{ category_name }} -
                            {% for entry in entries %}
                                {% if forloop.last %}
                                    <a href="{% url 'reports:del_entries_of_category' report.id entry.category_id %}">删除</a>
                                {% endif %}
                            {% endfor %}
                        </h3>
                <table>
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>项目 </th>
                            <th>检查结果 </th>
                            <th>单位 </th>
                            <th>范围 </th>
                            <th>提示 </th>
                        </tr>
                    </thead>
                    <tbody>
                            {% for entry in entries %}
                        <tr>
                            <td>{{ forloop.counter }}</td>
                            <td> {{ entry.name }}</td>
                            <td> {{ entry.check_results }}</td>
                            <td> {{ entry.unit }}</td>
                            <td> {{ entry.reference_range }}</td>
                            <td> {{ entry.tips }}</td>
                            <td><a href="{% url 'reports:del_entry' entry.id %}">删除</a> -
                                <a href="{% url 'reports:edit_entry' entry.id %}">修改</a></td>
                        </tr>
                           {% endfor %}
                    </tbody>
                </table>
                    {% empty %}
                    <p>还没有添加具体的检查项目，现在就从左边栏表单开始添加吧</p>
            {% endfor %}

            </td>
        </tr>
    </table>
{% endblock %}